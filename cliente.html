<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Cliente - Mercado Express</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    body { font-family: Arial; margin: 0; background-color: #fff8dc; }
    header { background-color: #0084ff; color: white; text-align: center; padding: 10px; }
    nav button { padding: 10px; margin: 5px; background-color: #ffcc00; border: none; border-radius: 5px; position: relative; }
    section { padding: 15px; }
    .btn { background-color: #28a745; color: white; padding: 10px; border: none; border-radius: 5px; margin: 5px; }
    #contador { font-size: 22px; color: #d32f2f; font-weight: bold; margin-top: 10px; }
    #map { height: 300px; margin-top: 10px; }
    #alerta { position: absolute; top: -5px; right: -5px; background: red; color: white; border-radius: 50%; padding: 2px 6px; font-size: 12px; display: none; }
  </style>
</head>
<body>

<header>
  <h1>ğŸ“¦ Cliente - Mercado Express</h1>
</header>

<nav>
  <button onclick="vista('noti')">ğŸ”” Notificaciones <span id="alerta">1</span></button>
  <button onclick="vista('mapa')">ğŸ—ºï¸ Ver paquete</button>
</nav>

<section id="noti">
  <div id="avisoLlegada" style="display:none; font-weight:bold; margin-bottom:10px;">
    ğŸ“¬ Tu paquete ha llegado. Â¿DeseÃ¡s programar la entrega?
  </div>

  <div id="acciones" style="display:none;">
    <button class="btn" onclick="accion('ahora')">âœ… Recibir ahora</button>
    <button class="btn" onclick="accion('posponer')">ğŸ•“ Posponer entrega</button>
  </div>

  <label>Lugar:</label><input type="text" placeholder="Ej. Calle 123"><br><br>
  <label>Hora:</label><input type="time"><br><br>
  <div id="contador"></div>
</section>

<section id="mapa" style="display:none;">
  <h2>Seguimiento en tiempo real</h2>
  <div id="map"></div>
</section>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  const map = L.map('map').setView([-51.6226, -69.2181], 14);
  L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

  // ğŸ“ Sucursal fija
  const sucursal = L.marker([-51.6215, -69.2185], {
    icon: L.icon({
      iconUrl: 'https://cdn-icons-png.flaticon.com/128/1483/1483336.png',
      iconSize: [32, 32],
      iconAnchor: [16, 32]
    })
  }).addTo(map).bindPopup('ğŸ¢ Sucursal Mercado Express');

  // ğŸ›µ Moto simulando paquete
  const paquete = L.marker([-51.6226, -69.2181], {
    icon: L.icon({
      iconUrl: 'https://cdn-icons-png.flaticon.com/128/826/826278.png',
      iconSize: [32, 32],
      iconAnchor: [16, 16]
    })
  }).addTo(map).bindPopup("ğŸ›µ Paquete en trÃ¡nsito");

  let puntoEntrega;
  let rutaEntrega;

  // Simular movimiento del paquete
  setInterval(() => {
    let pos = paquete.getLatLng();
    let
